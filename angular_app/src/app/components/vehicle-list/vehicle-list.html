<div class="vehicle-list-container">
  <div class="d-flex justify-content-between align-items-center mb-2 mt-2 p-2 bg-white shadow-sm rounded">
    <h6 class="mb-0 fw-bold">My Vehicles</h6>
    <button class="btn btn-primary btn-sm rounded-circle p-1" style="width: 36px; height: 36px;" (click)="refresh()">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="white">
        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
      </svg>
    </button>
  </div>

  <div *ngIf="vehicleService.isLoading$ | async" class="text-center py-5">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="!(vehicleService.isLoading$ | async) && (vehicleService.vehicles$ | async)?.length === 0" class="text-center py-5">
    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="#dee2e6">
      <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
    </svg>
    <p class="text-muted mt-3">No vehicles found</p>
    <p class="text-muted small">Upload your first vehicle to get started!</p>
  </div>

  <div class="vehicles-list" *ngIf="!(vehicleService.isLoading$ | async)">
    <div 
      class="vehicle-item" 
      *ngFor="let vehicle of vehicleService.vehicles$ | async; let i = index"
      (click)="openLightbox(vehicle, i)"
    >
      <!-- Thumbnail on Left -->
      <div class="vehicle-thumbnail">
        <img 
          [src]="getImageUrl(vehicle.id)" 
          [alt]="vehicle.number"
          class="thumbnail-image"
        />
      </div>
      
      <!-- Details on Right -->
      <div class="vehicle-details">
        <div class="vehicle-header">
          <h5 class="vehicle-number mb-1">{{ vehicle.number }}</h5>
        </div>
        
        <div class="vehicle-info">
          <div class="info-row">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="info-icon">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
            <span class="info-text">Owner: {{ vehicle.owner }}</span>
          </div>
          
          <div class="info-row">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="info-icon">
              <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
            </svg>
            <span class="info-text">{{ vehicle.timestamp }}</span>
          </div>
        </div>
        
        <div class="view-indicator">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
          </svg>
          <span class="ms-1 small">Tap to view</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Lightbox Modal -->
  <div class="lightbox" *ngIf="selectedVehicle" (click)="closeLightbox()">
    <div class="lightbox-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closeLightbox()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
      <img 
        [src]="getImageUrl(selectedVehicle.id)" 
        [alt]="selectedVehicle.number"
        class="lightbox-image"
      />
    </div>
  </div>
</div>
